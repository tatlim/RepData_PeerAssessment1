---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
```


## Loading and preprocessing the data

The following plots and calculations are based on [Activity Monitoring Data][1]
of an anonymous individual collected in October / November 2012.

[1]: https://d396qusza40orc.cloudfront.net/repdata/data/activity.zip


```{r load_data}
activity <-
    read.csv(
        file = unzip("./activity.zip"),
        colClasses = c("integer", "Date", "integer")
    )
```


## What is mean total number of steps taken per day?

The total number of daily steps varies as shown in the plot below.


```{r daily_steps}
# sum up total daily steps
daily_steps <- with(activity, tapply(steps, date, sum))

# calculate mean daily steps
mean_daily_steps <- format(mean(daily_steps, na.rm = TRUE), scientific = FALSE)

# find median of daily steps
median_daily_steps <- median(daily_steps, na.rm = TRUE)

# plot histogram of daily steps
hist(daily_steps,
     xlab = "Steps per Day",
     main = "Total Number of Steps per Day")
```

*Mean total number of daily steps* is **`r mean_daily_steps`** and *median* **`r median_daily_steps`**.

## What is the average daily activity pattern?

```{r daily_activity}
# calculate mean steps for each 5min interval
mean_steps_per_interval <- with(activity, tapply(steps, interval, mean, na.rm = TRUE))

# find maximum steps done in a 5min interval
max_steps_per_interval <- max(mean_steps_per_interval)

# identify the 5min interval with maximum steps
max_steps_interval <- names(which.max(mean_steps_per_interval))

# plot average steps per 5min interval
plot(
    names(mean_steps_per_interval),
    mean_steps_per_interval,
    type = "l",
    xlab = "5min interval",
    ylab = "mean steps per interval"
)
```

*Average daily activity* peaks in the morning hours with a maximum
at interval **`r max_steps_interval`**.

## Imputing missing values

```{r missing_values}
# logical vector of missing steps
missing_steps <- is.na(activity$steps)

# number of rows with NA steps
count_missing_steps <- sum(missing_steps)
```

Our *Activitiy Monitoring Dataset* has **`r count_missing_steps`** rows
with missing values (NA values).

My strategy for filling in these missing values will be to impute NA values
with the mean for the affected 5-minute interval.

```{r impute}
# create a copy of the original data frame
imputed_activity <- data.frame(activity)

# replace NAs with mean steps for affected interval
imputed_activity[missing_steps, ]$steps <-
    mean_steps_per_interval[as.character(imputed_activity[missing_steps, ]$interval)]

# sum up total daily steps
imp_daily_steps <- with(imputed_activity, tapply(steps, date, sum))

# calculate mean daily steps
mean_imp_daily_steps <-
    format(mean(imp_daily_steps, na.rm = TRUE), scientific = FALSE)

# find median of daily steps
median_imp_daily_steps <-
    format(median(imp_daily_steps, na.rm = TRUE), scientific = FALSE)

# plot histogram of daily steps
hist(imp_daily_steps,
     xlab = "Steps per Day",
     main = "Total Number of Steps per Day (NAs imputed)")
```

After imputing NA values *mean total number of daily steps* is **`r mean_imp_daily_steps`** and *median* **`r median_imp_daily_steps`**.

## Are there differences in activity patterns between weekdays and weekends?
```{r weekday}
# differentiate weekend from workday
day_type <-
    ifelse(weekdays(activity$date) %in% c("Saturday", "Sunday"),
           "weekend",
           "weekday")
# and add new column to activity data frame
activity$day_type <- as.factor(day_type)

mean_steps_by_day_type <-
    aggregate(
        formula = steps ~ interval + day_type,
        data = activity,
        FUN = mean,
        na.rm = TRUE
    )

# plot mean steps by day type
qplot(
    interval,
    steps,
    data = mean_steps_by_day_type,
    geom = "line",
    facets = day_type ~ .,
    xlab = "5min interval",
    ylab = "mean number of steps"
    #main = "Differences in Activity Patterns between Weekdays and Weekends"
)
```